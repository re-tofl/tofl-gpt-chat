package depgraph

import "sync"

type dgEntity[T any] struct {
	sync.Once
	value   T
	initErr error
}

func (e *dgEntity[T]) get(init func() (T, error)) (T, error) {
	e.Do(func() {
		e.value, e.initErr = init()
	})

	if e.initErr != nil {
		return *new(T), e.initErr
	}

	return e.value, nil
}
